(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d7700f48"],{"1f5b":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"manageWebCoupon-wrapper"},[o("a-tabs",[o("a-tab-pane",{key:"1",attrs:{tab:"网站优惠策略管理"}},[o("div",{staticStyle:{width:"100%","text-align":"right",margin:"20px 0"}},["Manager"==e.userInfo.userType?o("a-button",{attrs:{type:"primary"},on:{click:e.addCoupon}},[o("a-icon",{attrs:{type:"plus"}}),e._v("网站优惠策略")],1):e._e()],1),o("a-table",{attrs:{columns:e.columns,dataSource:e.webCouponList,bordered:"",pagination:!0},scopedSlots:e._u([{key:"couponType",fn:function(t){return o("span",{},[o("a-tag",{attrs:{color:"red"}},["1"==t?o("span",[e._v("节日特惠")]):e._e(),"2"==t?o("span",[e._v("多间特惠")]):e._e(),"3"==t?o("span",[e._v("满减优惠")]):e._e(),"4"==t?o("span",[e._v("限时优惠")]):e._e()])],1)}},{key:"action",fn:function(t){return o("span",{},[o("a-popconfirm",{attrs:{title:"确定想删除该优惠策略吗？",okText:"确定",cancelText:"取消"},on:{confirm:function(o){return e.confirmDeleteCoupon(t.id)}}},[o("a-button",{attrs:{type:"danger",size:"small"}},[e._v("删除优惠策略")])],1)],1)}}])})],1)],1),o("AddCouponModal")],1)},r=[],n=(o("d0bf"),o("6a61"),o("2e91")),i=o("d211"),s=o("cf6b"),u=o("e421"),d=[{title:"优惠类型",dataIndex:"couponType",scopedSlots:{customRender:"couponType"}},{title:"优惠卷名",dataIndex:"couponName"},{title:"折扣",dataIndex:"discount"},{title:"优惠简介",dataIndex:"description"},{title:"达标金额",dataIndex:"targetMoney"},{title:"优惠金额",dataIndex:"discountMoney"},{title:"有效起始时间",dataIndex:"startTime"},{title:"有效结束时间",dataIndex:"endTime"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],c={name:"manageWebCoupon",data:function(){return{columns:d,form:this.$form.createForm(this,{name:"manageWebCoupon"})}},components:{AddCouponModal:u["a"]},computed:Object(i["a"])({},Object(s["c"])(["userInfo","addCouponVisible","webCoupon","webCouponList"])),mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getWebCouponList();case 2:console.log(e.webCouponList);case 3:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(s["d"])(["set_addCouponVisible","set_webCoupon"])),Object(s["b"])(["getWebCouponList","deleteCoupon"])),{},{addCoupon:function(){this.set_addCouponVisible(!0)},confirmDeleteCoupon:function(e){var t={id:Number(e)};this.deleteCoupon(t)},confirmDeleteHotelCoupon:function(e){var t={id:Number(e)};this.deleteHotelCoupon(t)}})},m=c,l=(o("cb40"),o("c701")),p=Object(l["a"])(m,a,r,!1,null,"b50a29a4",null);t["default"]=p.exports},b348:function(e,t,o){},cb40:function(e,t,o){"use strict";o("b348")},e421:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-modal",{attrs:{visible:e.addCouponVisible,title:"添加优惠策略",cancelText:"取消",okText:"确定"},on:{cancel:e.cancel,ok:e.handleSubmit}},[o("a-form",e._b({staticStyle:{"margin-top":"30px"},attrs:{form:e.form}},"a-form",e.formItemLayout,!1),[o("a-form-item",e._b({attrs:{label:"优惠券类型"}},"a-form-item",e.formItemLayout,!1),[o("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["couponType",{rules:[{required:!0,message:"请选择类型"}]}],expression:"[\n                'couponType',\n                { rules: [{ required: true, message: '请选择类型' }] }]"}],on:{change:e.changeType}},[o("a-select-option",{attrs:{value:"2"}},[e._v("多间特惠")]),o("a-select-option",{attrs:{value:"3"}},[e._v("满减特惠")]),o("a-select-option",{attrs:{value:"4"}},[e._v("限时特惠")])],1)],1),o("a-form-item",{attrs:{label:"券名"}},[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["couponName",{rules:[{required:!0,message:"券名"}]}],expression:"['couponName', { rules: [{ required: true, message: '券名' }] }]"}],attrs:{placeholder:"券名"}})],1),o("a-form-item",e._b({attrs:{label:"优惠简介"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"请填写酒店简介"}]}],expression:"['description', { rules: [{ required: true, message: '请填写酒店简介' }] }]"}],attrs:{type:"textarea",rows:4,placeholder:"请填写优惠简介"}})],1),o("a-form-item",e._b({attrs:{label:"适用时间"}},"a-form-item",e.formItemLayout,!1),[o("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["date",{rules:[{required:!0,message:"请选择适用时间"}]}],expression:"[\n                    'date',\n                    {\n                        rules: [{ required: true, message: '请选择适用时间' }]\n                    }\n                ]"}],attrs:{"disabled-date":e.disabledDate,"show-time":"",format:"YYYY-MM-DD hh:mm:ss",placeholder:["开始时间","结束时间"]}})],1),1==e.targetRoom?o("a-form-item",e._b({attrs:{label:"达标房间数"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["targetRoomNum",{rules:[{required:!0,message:"请填写达标房间数"}]}],expression:"['targetRoomNum', { rules: [{ required: true, message: '请填写达标房间数' }] }]"}],attrs:{placeholder:"请填写达标房间数"}})],1):e._e(),0==e.targetMoney?o("a-form-item",e._b({attrs:{label:"折扣"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["discount",{rules:[{required:!0,message:"折扣"}]}],expression:"['discount', { rules: [{ required: true, message: '折扣' }] }]"}],attrs:{placeholder:"请填写折扣"}})],1):e._e(),o("a-form-item",e._b({attrs:{label:"达标金额"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["targetMoney",{rules:[{required:!0,message:"请填写达标金额"}]}],expression:"['targetMoney', { rules: [{ required: true, message: '请填写达标金额' }] }]"}],attrs:{placeholder:"请填写达标金额"}})],1),o("a-form-item",e._b({attrs:{label:"优惠金额"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["discountMoney",{rules:[{required:!0,message:"请填写优惠金额"}]}],expression:"['discountMoney', { rules: [{ required: true, message: '请填写优惠金额' }] }]"}],attrs:{placeholder:"请填写优惠金额"}})],1),o("a-form-item",e._b({attrs:{label:"仅面向会员"}},"a-form-item",e.formItemLayout,!1),[o("a-switch",{on:{click:e.vipOrientedChange},model:{value:e.targetVIP,callback:function(t){e.targetVIP=t},expression:"targetVIP"}},[o("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),o("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1)],1)],1)],1)},r=[],n=(o("d0bf"),o("d211")),i=o("cf6b"),s=o("caaf"),u={name:"addCouponModal",data:function(){return{formItemLayout:{labelCol:{xs:{span:12},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},targetMoney:!0,targetTime:!1,targetRoom:!1,targetVIP:!1}},computed:Object(n["a"])({},Object(i["c"])(["currentHotelId","addCouponVisible","webCoupon","userInfo"])),beforeCreate:function(){this.form=this.$form.createForm(this,{name:"addCouponModal"})},mounted:function(){},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(i["d"])(["set_addCouponVisible"])),Object(i["b"])(["addHotelTargetMoneyCoupon","addHotelTargetRoomCoupon","addHotelTargetTimeCoupon"])),{},{cancel:function(){this.set_addCouponVisible(!1),this.targetVIP=!1},changeType:function(e){"3"==e?(this.targetMoney=!0,this.targetRoom=!1,this.targetTime=!1):"2"==e?(this.targetMoney=!1,this.targetRoom=!0,this.targetTime=!1):"4"==e&&(this.targetMoney=!1,this.targetRoom=!1,this.targetTime=!0)},disabledDate:function(e){return e&&e<s().startOf("day")},vipOrientedChange:function(){this.targetVIP=!0},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFieldsAndScroll((function(e,o){if(!e){var a={hotelId:"Manager"===t.userInfo.userType?0:Number(t.currentHotelId),type:t.form.getFieldValue("couponType"),description:t.form.getFieldValue("description"),name:!0===t.targetVIP?"Manager"===t.userInfo.userType?"网站会员专属":"酒店会员专属":"Manager"===t.userInfo.userType?"全网站用户共享优惠":t.form.getFieldValue("couponName"),targetMoney:Number(t.form.getFieldValue("targetMoney")),discountMoney:Number(t.form.getFieldValue("discountMoney")),startTime:s(t.form.getFieldValue("date")[0]).format("YYYY-MM-DD hh:mm:ss"),endTime:s(t.form.getFieldValue("date")[1]).format("YYYY-MM-DD hh:mm:ss"),forHotelVip:!0===t.targetVIP?1:0};if(t.webCoupon&&(a=Object(n["a"])({hotelId:Number(0)},a)),console.log(a),t.targetRoom){var r=Object(n["a"])({targetRoom:Number(t.form.getFieldValue("targetRoomNum")),discount:Number(t.form.getFieldValue("discount"))},a);console.log(r),t.addHotelTargetRoomCoupon(r).then((function(){t.form.setFieldsValue({couponType:"",description:"",couponName:"",targetMoney:"",date:"",targetRoomNum:"",discount:"",discountMoney:""})}))}if(t.targetTime){var i=Object(n["a"])({discount:Number(t.form.getFieldValue("discount"))},a);t.addHotelTargetTimeCoupon(i).then((function(){t.form.setFieldsValue({couponType:"",description:"",couponName:"",targetMoney:"",date:"",targetRoomNum:"",discount:"",discountMoney:""})}))}t.targetMoney&&t.addHotelTargetMoneyCoupon(a).then((function(){t.form.setFieldsValue({couponType:"",description:"",couponName:"",targetMoney:"",date:"",targetRoomNum:"",discount:"",discountMoney:""})})),t.targetMoney=!0,t.targetRoom=!1,t.targetTime=!1,t.targetVIP=!1}}))}})},d=u,c=o("c701"),m=Object(c["a"])(d,a,r,!1,null,null,null);t["a"]=m.exports}}]);
//# sourceMappingURL=chunk-d7700f48.12a25e06.js.map